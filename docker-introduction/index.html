<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Introduction to Docker</title>

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="../reveal/css/reveal.css">
    <link rel="stylesheet" href="css/docker.css" id="theme">
    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="../reveal/lib/css/zenburn.css">
    <!-- Printing and PDF exports -->
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = window.location.search.match(/print-pdf/gi) ? '../reveal/css/print/pdf.css' : '../reveal/css/print/paper.css';
        document.getElementsByTagName('head')[0].appendChild(link);
    </script>
    <!--[if lt IE 9]>
    <script src="../reveal/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>


<div class="reveal">
<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
<section>
    <h1>Introduction to Docker</h1>

    <div>
        <img src="img/docker.png" style="width: 432px; height: 376px; max-height: none; max-width: none;"/>
        <br/>
    </div>
    <h1>
        What - Why - How
    </h1>
    <pre>
        Hit Page down...
    </pre>
</section>

<section>
    <section>
        <h1>Docker, Containers and the Matrix from Hell</h1>
    </section>

    <section>
        <h2>Cargo Transport Pre-1960</h2>

        <img style="width: 100%;" src="img/cargo-transport-pre-1960.png">
    </section>

    <section>
        <h2>The Matrix from Hell</h2>

        <img style="width: 100%;" src="img/also-a-matrix-from-hell.png">
    </section>

    <section>
        <h2>Solution: Intermodal Shipping Container</h2>

        <img style="width: 100%;" src="img/intermodal-shipping-container.png">
        </p>
    </section>

    <section>
        <h2>The Challenge</h2>

        <img style="width: 100%;" src="img/the-challenge.png">
    </section>


    <section>
        <h2>Also a Matrix from Hell</h2>

        <img style="width: 100%;" src="img/the-matrix-from-hell.png">
    </section>

    <section>
        <h2>Docker is a Container System for Code</h2>

        <img style="width: 100%;" src="img/shipping-container-for-code.png">
    </section>

    <section>
        <h2>Docker Eliminates the Matrix from Hell</h2>

        <img style="width: 100%;" src="img/eliminates-matrix-from-hell.png">
    </section>
</section>

<section>
    <section>
      <h1 class="fragment current-visible">So what IS Docker?</h1>
      <div class="fragment">
        <h1 class="fragment highlight-current-blue">Docker is an<br/><br/>Application packaging technology</h1>
        <ul style="list-style: none">
          <li class="fragment highlight-current-blue">
              that allows you
          <li/>
          <li class="fragment highlight-current-blue">
              to package an application
          <li/>
          <li class="fragment highlight-current-blue">
              with all of its dependencies
          <li/>
          <li class="fragment highlight-current-blue">
              into a standardized unit for software development
          <li/>
        </ul>
    </div>
    </section>
    <section>
        <h1>Docker Main Features</h1>
        <ul style="margin-top: 20px;text-align: left">
            <li class="fragment">
                Lightweight
            </li>
            <li class="fragment">
                Isolated and content agnostic
            </li>
            <li class="fragment">
                Build once, run everywhere
            </li>
            <li class="fragment">
                Easily distributable
            </li>
        </ul>
        <aside class="notes"><pre class="fragment" style="text-align: left; margin-top: 20px;font-size: 10px;"><code class="bash" data-trim>
          Lightweight like a process
          Container virtualization - Separation of Concerns
          Devs have a near production dev machine
          Using registries - Distributable images without overhead
        </code></pre></aside>
    </section>
    <section>
        <h1>How much lightweihgt?</h1>
        <h2>VMs vs Containers</h2>

        <img style="width: 100%;" src="img/containers-vs-vms.png">
    </section>
    <section>
        <h1>Why Devs/DevOps care</h1>
        <h2>Separation of Concerns</h2>

        <img style="width: 100%;" src="img/separation-of-concerns.png">
    </section>
    <section>
        <h2>Why Developers Care</h2>

        <div style="text-align: left;">
            As a Developer I can...
            <ul style="margin-top: 20px;">
                <li class="fragment">have a clean, safe, hygienic, isolated and portable runtime environment for my app
                </li>
                <li class="fragment">have a close to production environment for developing
                </li>
                <li class="fragment">have no worries about missing dependencies, configuration, conflicting versions and
                    other pain points during developing
                </li>
                <li class="fragment">automate testing, integration, packaging…anything you can script
                </li>
                <li class="fragment">test with different versions without risking the stable setup
                </li>
                <li class="fragment">distribute the isolated container to anyone needs my app on their machine either
                    inhouse (developers, QA) or externally (customers, servers)
                </li>
            </ul>
        </div>
    </section>
    <section>
        <h2>Why Developers Care - continued...</h2>

        <div style="text-align: left;">
            As a Developer I can...
            <ul style="margin-top: 20px;">
                <li class="fragment">reduce/eliminate concerns about compatibility on different platforms, either your
                    own or your customers
                </li>
                <li class="fragment">have a working environment fast and reliably
                </li>
                <li class="fragment">have a VM without the overhead of a VM
                </li>
                <li class="fragment">instant replay and reset of image snapshots
                </li>
                <li class="fragment" style="font-weight: bold">That’s the power of Docker
                </li>
            </ul>
        </div>
    </section>
    <section>
        <h1>Why Devops care?</h1>

        <div style="text-align: left;">
            As a DevOps I can...
            <ul>
                <li class="fragment">configure once, distribute anywhere
                </li>
                <li class="fragment">make the entire lifecycle more efficient, consistent, and repeatable
                </li>
                <li class="fragment">
                    eliminate inconsistencies between development, test, production, and customer environments
                </li>
                <li class="fragment">
                    support segregation of duties
                </li>
                <li class="fragment">
                    significantly improve the speed and reliability of continuous deployment and continuous integration
                    systems
                </li>
                <li class="fragment">
                    because the containers are so lightweight, address significant performance, costs, deployment, and
                    portability issues normally associated with VMs
                </li>
            </ul>
        </div>
    </section>
</section>

<section>
    <section>
        <h1>Docker entities</h1>
    </section>
    <section>
        <h1>Dockerfile</h1>

        <p style="text-align: left;">
            A Dockerfile contains the instructions to build an image
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px; background-color: #333333"><code class="bash">
FROM ubuntu

RUN apt-get install --assume-yes -qq memcached telnet
USER daemon

EXPOSE 11211

CMD ["memcached", "-u", "root"]
        </code></pre>
    </section>
    <section>
        <h1>Image</h1>

        <p style="text-align: left;">
            A read-only File layer containing Libs/App
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
docker build -t="memcached" .
# List all images
docker images
        </code></pre>
        <ul style="text-align: left; margin-top: 20px;">
            <li class="fragment">
                Images never change. Instead they are re-built.
            </li>
            <li class="fragment">
                Images do not have state.
            </li>
            <li class="fragment">
                Images are stored in repositories and can be distributed through a Registry servers.
            </li>
        </ul>
    </section>
    <section>
        <h1>Container</h1>

        <p style="text-align: left;">
            To activate a "VM" in Docker you run a container from an Image.
        </p>
           <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
docker run -d -p 11211:11211 --name "memcached" memcached
# List running containers
docker ps
           </code></pre>
    </section>
    <section>
        <h1>Docker compose</h1>

        <p style="text-align: left;">
            A tool to define and activate a multi-container application "bundle" of containers in a single file,
            then spin your application up in a single command.
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="yml">
 wp:
   image: library/wordpress:latest
   ports:
     - 80:80
   links:
     - mysql:mysql
 mysql:
   image: mysql:latest
   environment:
     - MYSQL_ROOT_PASSWORD=root
   volumes:
     - ./data/mysql:/var/lib/mysql
     - ./log/mysql:/var/log/mysql
.
</code></pre>
    </section>
    <section>
        <h1>Repository</h1>

        <p class="fragment" style="text-align: left;">
            A repository is a set of images on your local Docker server.
        </p>

        <p class="fragment" style="text-align: left;">
            They can be shared by pushing it to a Registry server.
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
            docker images
        </code></pre>
    </section>
    <section>
        <h1>Registry server</h1>

        <p class="fragment" style="text-align: left;">
            A Registry is a hosted service containing repositories of images which responds to the Registry API.
        </p>

        <p class="fragment" style="text-align: left;">
            You need a registry to pull Images you want to use.
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
            docker pull apache2
        </code></pre>
    </section>
    <section>
        <h1>Docker flow</h1>

        <img style="width: 100%;" src="img/basics-of-docker-system.png">

        <h2>Image - Container - Registry</h2>
    </section>
</section>

<section>
  <section>
      <!-- WETTY -->
      <iframe width="1000" height="500" frameborder="0" allowfullscreen="" src="https://localhost:2233/wetty/ssh/user"></iframe>

      <aside class="notes">
      <pre class="fragment" style="text-align: left; margin-top: 20px;font-size: 10px;"><code class="bash" data-trim>
  cd /terminal/; clear;
  docker build -t="memcached" .
  docker images | grep memcached
  docker ps | grep memcached
  docker run -d -p 11211:11211 --name "memcached" memcached
  netstat -ntlp | grep 11211
  telnet 127.0.0.1 11211
  stats items
  set Test 0 100 10
  JournalDev
  stats items
  CTRL + ]
  close
  docker rm -f memcached
  docker run -it -e API_KEY=c938492693a9ef73deda252dabcea georgeyord/wego
  docker run -it --rm supertest2014/nyan

  DEBUG:
  docker exec -d -p 11211:11211 memcached bash

  cd /terminal/; clear;
  docker-compose up
  docker-compose ps
      </code></pre>
      </aside>
  </section>
</section>

<section>
    <section>
        <h2>Under the hood</h2>
        <ul style="text-align: left">
            <li class="fragment">
                High Level — It IS INDEED a lightweight VM
            </li>
            <li class="fragment">
                Own process space
            </li>
            <li class="fragment">
                Own network interface
            </li>
            <li class="fragment">
                Can share file volumes with host <i>or not</i>
            </li>
            <li class="fragment">
                Can run stuff as root (is also the default way)
            </li>
            <li class="fragment">
                Can have its own /sbin/init (different from host)
            </li>
        </ul>
    </section>
    <section style="text-align: left">
        <h4>Technology Stack</h4>

        <h1>A lightweight VM = LXC (Linux Containers)</h1>

        <p class="fragment">
            <i>an operating-system-level virtualization environment for running multiple isolated Linux systems
                (containers) on a single Linux control host.</i>
        </p>
    </section>
    <section style="text-align: left">
        <h4>Technology Stack</h4>

        <h1>Own process space = Kernel Namespaces and cgroups</h1>

        <p class="fragment">
            <i> behind the scenes Docker creates a set of namespaces and control groups for the container.</i>
        </p>
    </section>
    <section style="text-align: left">
        <h4>Technology Stack</h4>

        <h1>Own network interface = Advanced virtual network interface</h1>

        <p class="fragment">
            <i>
                a virtual Ethernet bridge that automatically forwards packets between any other network
                interfaces that are attached to it. This lets containers communicate both with the host machine and with
                each other.</i>
        </p>
    </section>
    <section style="text-align: left">
        <h4>Technology Stack</h4>

        <h1>File volumes = Union File System</h1>

        <p class="fragment"><i>a Git alike merging of file layers that produces a final filesystem structure.</i></p>

        <div class="fragment">
            In Union File System, the processes think the whole file system is mounted read-write. But all the changes
            go to the top-most writeable layer, and underneath, the original file in the read-only image is unchanged.
            All read-only Layers are called images. An image never changes.
        </div>
    </section>
</section>

<section>
    <section>
        <h1>Docker in production</h1>

        <div style="text-align: left">
            <ul style="font-size: smaller">
                <li class="fragment">
                    Google
                </li>
                <li class="fragment" style="list-style: none">
                    <i>
                        Everything at Google, from Search to Gmail, is packaged and run in a Linux container.
                        Each week we launch more than <b>2 billion</b> container instances across our global data
                        centers.
                    </i>
                </li>
                <li class="fragment">
                    New Relic - Insights
                </li>
                <li class="fragment" style="list-style: none">
                    <i>
                        "Docker has helped us deliver new services faster than ever before." <br>
                        - Nic Benders, Director of Site Engineering
                    </i>
                </li>
                <li class="fragment">
                    Ebay - Continuous integration
                </li>
                <li class="fragment" style="list-style: none">
                    <i>
                        "We use Docker to implement an efficient, automated path from the developer's laptop through
                        test and QA.<br>
                        - Senior Architect Ted Dziuba
                    </i>
                </li>
                <li class="fragment">
                    Cambridge Healthcare - Continuous Delivery
                </li>
                <li class="fragment" style="list-style: none">
                    <i>
                        They replaced several AWS AMIs with a single bare metal host running Docker to
                        speed up their Jenkins-based continuous delivery pipeline.
                    </i>
                </li>
            </ul>
        </div>
    </section>
</section>

<section>
    <section>
        <h1>Docker + Tripsta = ?</h1>
        <h2 class="fragment">Current state + Future options</h2>
    </section>
    <section>
        <h1>Current state</h1>
        <ul style="text-align: left">
            <li class="fragment">
                Images for most of our <a href="https://github.com/tripsta/docker/tree/master/containers">services</a>
            </li>
              <li class="fragment">
                  Compose bundles for most of our <a href="https://github.com/tripsta/docker/tree/master/compose">applications</a>
              </li>
            <li class="fragment">
                Private registry inside company's VPN <a href="http://docker.tripsta.net:5080/repository/index">docker.tripsta.net</a>
            </li>
        </ul>
    </section>
    <section>
        <h1>A Bundle example</h1>
        <h2>External services bundle</h2>
        <img style="height: 100%;" src="https://www.lucidchart.com/publicSegments/view/555c4fd8-6da8-497a-b742-17f60a009639/image.png">
    </section>
    <section>
        <h1>External services without hassle</h1>

        <p class="fragment current-visible">
            <span style='color:black'>sudo apt-get install mysql elasticsearch rabbitmq</span>
        </p>
        <p style="color:darkcyan;text-decoration:line-through;" class="fragment">
            <span style='color:black'>sudo apt-get install mysql elasticsearch rabbitmq</span>
        </p>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
            ./compose.sh external-services up -d
        </code></pre>
        <table class="fragment" style="text-align: left; background-color: rgba(100, 100, 100, 0.2); width: 100%;padding: 10px;">
            <thead>
            <td>
                Service
            </td>
            <td>
                State
            </td>
            </thead>
            <tr>
                <td>
                    externalservices_elasticsearch_1
                </td>
                <td>
                    Up
                </td>
            </tr>
            <tr>
                <td>
                    externalservices_gearman_1
                </td>
                <td>
                    Up
                </td>
            </tr>
            <tr>
                <td>
                    externalservices_mysql_1
                </td>
                <td>
                    Up
                </td>
            </tr>
            <tr>
                <td>
                    externalservices_rabbitmq_1
                </td>
                <td>
                    Up
                </td>
            </tr>
        </table>
    </section>
    <section>
        <h1>A feature-full Bundle example</h1>
        <h2>TP24 bundle</h2>
        <img style="height: 100%;" src="https://www.lucidchart.com/publicSegments/view/555c4fe8-999c-4a7e-8edb-180d0a00df49/image.png">
    </section>
    <section>
        <h1>Development environment for TP24</h1>
        <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash">
            ./compose.sh tp24 up -d
            # No more configuration issues!
        </code></pre>

        <p class="fragment" style="text-align: left;">
            Run migrations
            <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash" >
./compose.sh run helper php scripts/db/migrate.php
            </code></pre>
        </p>
        <p class="fragment" style="text-align: left;">
            Run tests
            <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash" >./compose.sh run helper ant</code></pre>
        </p>
        <p class="fragment" style="text-align: left;">
            Run watchr
            <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash" >./compose.sh run helper watchr tests/watchr.rb</code></pre>
        </p>
    </section>
    <section>
        <h1>Development environment for TP24 - continued</h1>

        <p class="fragment" style="text-align: left;">
            Connect to MySQL
            <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash" >./compose.sh run helper php scripts/db/connect.php</code></pre>
        </p>

        <p class="fragment" style="text-align: left;">
            Anything...
            <pre class="fragment" style="text-align: left; margin-top: 20px;"><code class="bash" >./compose.sh run helper [do anything you did]</code></pre>
        </p>
    </section>
    <section>
        <h1>The big picture</h1>
        <img style="width: 100%;" src="https://www.lucidchart.com/publicSegments/view/555c4f94-0f54-4953-8e53-5cda0a008aee/image.png">
    </section>
    <section>
        <h1>The future</h1>

        <ul style="text-align: left">
            <li class="fragment">
                Have a <span style="font-weight: bold">real</span> Private registry<br>
                <i style="font-size: smaller">Improve stability, accessibility</i>
            </li>
            <li class="fragment">
                Automate the bundle activation and orchestration<br>
                <i style="font-size: smaller">Spin up staging environments on demand</i>
            </li>
            <li class="fragment">
                Automate the testing<br>
                <i style="font-size: smaller">Have a <span class="fragment highlight-current-blue">fully blown</span> <span class="fragment highlight-current-red">temporary</span> testing infrustructre</i>
            </li>
            <li class="fragment">
                ...
            </li>
        </ul>
    </section>
</section>

<section>
    <section>
        <h1>Thank you!</h1>
        <h2 style="margin-top: 100px;text-align: left;">Information for the presentation</h2>
        <ul style="text-align: left; font-size: smaller;">
            <li>Written in HTML Presentation Framework <a href="http://lab.hakim.se/reveal-js/">Reveal.js</a></li>
            <li><a href="https://github.com/krishnasrinivas/wetty">Wetty</a> terminal used for live presentation</li>
            <li>Presentation run on nodejs using grunt</li>
            <li>Ofcourse, everything run on Docker</li>
        </ul>
    </section>
    <section>
        <h2>Want to Learn More?</h2>
        <ul style="text-align: left">
            <li><a href="http://www.docker.com/">www.docker.com</a></li>
            <ul>
                <li>Documentation</li>
                <li>Getting started (tutorial, installation, guide, etc)</li>
            </ul>
            <li>Meetups: <a href="http://www.meetup.com/Docker-Athens">Docker-Athens</a></li>
        </ul>
    </section>
</section>
</div>


</div>

<script src="../reveal/lib/js/head.min.js"></script>
<script src="../reveal/js/reveal.js"></script>

<script>

    // Full list of configuration options available at:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,
        // Display a presentation progress bar
        progress: true,
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Enable keyboard shortcuts for navigation
        keyboard: true,
        // Enable the slide overview mode
        overview: true,
        // Vertical centering of slides
        center: true,
        // Enables touch navigation on devices with touch input
        touch: false,
        // Loop the presentation
        loop: false,
        // Turns fragments on and off globally
        fragments: true,
        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,
        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,
        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,
        // Stop auto-sliding after user input
        autoSlideStoppable: true,
        // Enable slide navigation via mouse wheel
        mouseWheel: true,
        // Hides the address bar on mobile devices
        hideAddressBar: true,
        // Opens links in an iframe preview overlay
        previewLinks: false,
        // Transition style
        transition: 'convex', // none/fade/slide/convex/concave/zoom
        // Transition speed
        transitionSpeed: 'default', // default/fast/slow
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom
        // Number of slides away from the current that are visible
        viewDistance: 3,
        // Parallax background image
        parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"
        // Parallax background size
        parallaxBackgroundSize: '', // CSS syntax, e.g. "2100px 900px"
        // Amount to move parallax background (horizontal and vertical) on slide change
        // Number, e.g. 100
        parallaxBackgroundHorizontal: '',
        parallaxBackgroundVertical: '',

        // Optional reveal.js plugins
        dependencies: [
            // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
            { src: '../reveal/lib/js/classList.js', condition: function () { return !document.body.classList; } }

            // Interpret Markdown in <section> elements
            ,{ src: '../reveal/plugin/markdown/marked.js', condition: function () { return !!document.querySelector('[data-markdown]'); } }
            ,{ src: '../reveal/plugin/markdown/markdown.js', condition: function () { return !!document.querySelector('[data-markdown]'); } }

            // Zoom in and out with Alt+click
            ,{ src: '../reveal/plugin/zoom-js/zoom.js', async: true }

            // Syntax highlight for <code> elements
            ,{ src: '../reveal/plugin/highlight/highlight.js', async: true, condition: function () {
                return !!document.querySelector('pre code'); }, callback: function () { hljs.initHighlightingOnLoad(); }
            }

            // Remote control your reveal.js presentation using a touch device
            ,{ src: '../reveal/plugin/remotes/remotes.js', async: true }

            // Speaker notes
            ,{ src: '../reveal/plugin/notes/notes.js', async: true }

            // MathJax
            //,{ src: 'plugin/math/math.js', async: true }
        ]
    });

</script>

</body>
</html>
